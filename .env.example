# Rostio Configuration Example
# Copy this file to .env and customize for your environment

# Database Configuration
DATABASE_URL=sqlite:///./roster.db

# Rate Limiting Configuration (for bot prevention)
# All limits are per IP address

# Signup Rate Limit (new user registration)
# Default: 3 requests per hour
RATE_LIMIT_SIGNUP_MAX=3
RATE_LIMIT_SIGNUP_WINDOW=3600

# Login Rate Limit (authentication attempts)
# Default: 5 requests per 5 minutes
RATE_LIMIT_LOGIN_MAX=5
RATE_LIMIT_LOGIN_WINDOW=300

# Create Organization Rate Limit
# Default: 2 requests per hour
RATE_LIMIT_CREATE_ORG_MAX=2
RATE_LIMIT_CREATE_ORG_WINDOW=3600

# Create Invitation Rate Limit (admins sending invitations)
# Default: 10 requests per 5 minutes
RATE_LIMIT_CREATE_INVITATION_MAX=10
RATE_LIMIT_CREATE_INVITATION_WINDOW=300

# Verify Invitation Rate Limit (users checking invitation tokens)
# Default: 10 requests per minute
RATE_LIMIT_VERIFY_INVITATION_MAX=10
RATE_LIMIT_VERIFY_INVITATION_WINDOW=60

# Password Reset Request Rate Limit (requesting reset email)
# Default: 3 requests per hour
RATE_LIMIT_PASSWORD_RESET_MAX=3
RATE_LIMIT_PASSWORD_RESET_WINDOW=3600

# Password Reset Confirm Rate Limit (confirming reset with token)
# Default: 5 requests per 5 minutes
RATE_LIMIT_PASSWORD_RESET_CONFIRM_MAX=5
RATE_LIMIT_PASSWORD_RESET_CONFIRM_WINDOW=300

# reCAPTCHA v3 Configuration (for bot protection)
# Get keys from https://www.google.com/recaptcha/admin
RECAPTCHA_SITE_KEY=your_site_key_here
RECAPTCHA_SECRET_KEY=your_secret_key_here
# Score threshold (0.0-1.0, default 0.5)
# Lower = more permissive, Higher = more restrictive
RECAPTCHA_MIN_SCORE=0.5

# Testing Mode (disables rate limiting and reCAPTCHA)
# Set to "true" during tests, leave unset in production
# TESTING=true

# Security Headers Configuration
# Environment: "development" or "production"
ENVIRONMENT=development

# HSTS (HTTP Strict Transport Security)
# Enable HSTS header (forces HTTPS)
# Recommended: true in production with HTTPS, false in development
SECURITY_HSTS_ENABLED=false
# HSTS max-age in seconds (default: 31536000 = 1 year)
SECURITY_HSTS_MAX_AGE=31536000

# CSP (Content Security Policy)
# Enable CSP header (prevents XSS and injection attacks)
SECURITY_CSP_ENABLED=true

# X-Frame-Options (prevents clickjacking)
# Values: DENY, SAMEORIGIN, or ALLOW-FROM uri
SECURITY_FRAME_OPTIONS=DENY

# Password Strength Requirements
# Minimum password length (default: 8)
PASSWORD_MIN_LENGTH=8
# Require uppercase letter (default: true)
PASSWORD_REQUIRE_UPPERCASE=true
# Require lowercase letter (default: true)
PASSWORD_REQUIRE_LOWERCASE=true
# Require number (default: true)
PASSWORD_REQUIRE_NUMBER=true
# Require special character (default: true)
PASSWORD_REQUIRE_SPECIAL=true
# Allowed special characters (default: !@#$%^&*()_+-=[]{}|;:,.<>?)
PASSWORD_SPECIAL_CHARS=!@#$%^&*()_+-=[]{}|;:,.<>?

# JWT Configuration
# JWT secret key (CHANGE THIS IN PRODUCTION!)
SECRET_KEY=your-secret-key-change-in-production
# JWT algorithm (default: HS256)
ALGORITHM=HS256
# JWT access token expiration in hours (default: 24)
ACCESS_TOKEN_EXPIRE_HOURS=24

# Session Configuration
# Session timeout in hours (default: 24)
SESSION_TIMEOUT_HOURS=24
# Require re-authentication after this many hours of inactivity
SESSION_IDLE_TIMEOUT_HOURS=2
