# ============================================================================
# SignUpFlow Development Environment Configuration
# ============================================================================
# This file defines the STRUCTURE and DEFAULTS for development environment.
# Sensitive values (passwords, keys) come from .env file.
#
# Usage:
#   1. Copy .env.example to .env
#   2. Fill in sensitive values in .env
#   3. Run: docker-compose up (reads this profile automatically)
#
# Priority: .env values > this file defaults
# Committed to git: YES (no secrets here!)
# ============================================================================

environment: development

# ============================================================================
# Application
# ============================================================================
app:
  name: SignUpFlow
  version: 1.0.0
  debug: true
  reload: true  # Hot reload for development
  log_level: DEBUG

  # URLs
  url: http://localhost:8000
  api_base_url: http://localhost:8000
  frontend_url: http://localhost:8000

  # Server
  host: 0.0.0.0
  port: 8000
  workers: 1  # Single worker for development (easier debugging)

# ============================================================================
# Database
# ============================================================================
database:
  # PostgreSQL (via Docker Compose)
  type: postgresql
  host: db
  port: 5432
  name: signupflow_dev
  user: signupflow
  # password: FROM .env (POSTGRES_PASSWORD)

  # Connection Pool
  pool_size: 5
  max_overflow: 10

  # Fallback to SQLite for local development without Docker
  # sqlite_path: ./roster.db

# ============================================================================
# Redis
# ============================================================================
redis:
  host: redis
  port: 6379
  db: 0
  # password: FROM .env (REDIS_PASSWORD)

  # Features
  enabled: true
  rate_limiting_enabled: true
  session_ttl_hours: 24

# ============================================================================
# Authentication & Security
# ============================================================================
auth:
  # JWT
  # secret_key: FROM .env (SECRET_KEY)
  algorithm: HS256
  access_token_expire_hours: 24

  # Password Reset
  password_reset_token_ttl: 3600  # 1 hour

  # reCAPTCHA
  recaptcha:
    enabled: false  # Disable in development
    # site_key: FROM .env (RECAPTCHA_SITE_KEY)
    # secret_key: FROM .env (RECAPTCHA_SECRET_KEY)

  # Two-Factor Authentication
  totp:
    enabled: false  # Disable in development
    # encryption_key: FROM .env (TOTP_ENCRYPTION_KEY)

# ============================================================================
# Rate Limiting
# ============================================================================
rate_limiting:
  enabled: true

  # Signup
  signup_max: 10  # Relaxed for development
  signup_window: 3600

  # Login
  login_max: 10  # Relaxed for development
  login_window: 300

  # Organization Creation
  create_org_max: 5
  create_org_window: 3600

  # Invitation
  create_invitation_max: 20
  create_invitation_window: 300
  verify_invitation_max: 20
  verify_invitation_window: 60

  # Password Reset
  password_reset_max: 5
  password_reset_window: 3600
  password_reset_confirm_max: 10
  password_reset_confirm_window: 300

# ============================================================================
# Email
# ============================================================================
email:
  enabled: false  # Default off, enable in .env to test

  # Mailtrap (Development Email Testing)
  provider: mailtrap
  smtp:
    host: sandbox.smtp.mailtrap.io
    port: 2525
    # user: FROM .env (MAILTRAP_SMTP_USER)
    # password: FROM .env (MAILTRAP_SMTP_PASSWORD)

  # Mailtrap API (for automated email verification in tests)
  api:
    # token: FROM .env (MAILTRAP_API_TOKEN)
    # account_id: FROM .env (MAILTRAP_ACCOUNT_ID)
    # inbox_id: FROM .env (MAILTRAP_INBOX_ID)

  # From Address
  from_email: noreply@signupflow.io
  from_name: SignUpFlow

# ============================================================================
# SMS
# ============================================================================
sms:
  enabled: false  # Default off, enable in .env to test

  # Twilio
  provider: twilio
  # account_sid: FROM .env (TWILIO_ACCOUNT_SID)
  # auth_token: FROM .env (TWILIO_AUTH_TOKEN)
  # phone_number: FROM .env (TWILIO_PHONE_NUMBER)

  # Webhooks
  status_callback_url: http://localhost:8000/api/webhooks/twilio/status
  incoming_sms_url: http://localhost:8000/api/webhooks/twilio/incoming

# ============================================================================
# Payment (Stripe)
# ============================================================================
billing:
  enabled: false  # Default off for development

  provider: stripe
  test_mode: true  # Always use test mode in development
  # publishable_key: FROM .env (STRIPE_PUBLISHABLE_KEY)
  # secret_key: FROM .env (STRIPE_SECRET_KEY)
  # webhook_secret: FROM .env (STRIPE_WEBHOOK_SECRET)

  # Price IDs (create in Stripe Dashboard)
  # prices:
  #   starter_monthly: FROM .env
  #   starter_annual: FROM .env
  #   pro_monthly: FROM .env
  #   pro_annual: FROM .env

# ============================================================================
# Features
# ============================================================================
features:
  calendar_export: true
  solver: true
  analytics: true  # Enable for development
  mobile_app: false
  onboarding_wizard: true

# ============================================================================
# Monitoring
# ============================================================================
monitoring:
  # Sentry
  sentry:
    enabled: false  # Disable in development
    # dsn: FROM .env (SENTRY_DSN)

# ============================================================================
# CORS
# ============================================================================
cors:
  origins:
    - http://localhost:8000
    - http://127.0.0.1:8000
    - http://localhost:3000  # For separate frontend dev server
  credentials: true

# ============================================================================
# Testing
# ============================================================================
testing:
  enabled: true
  test_database_url: postgresql://signupflow:test_password@db:5432/signupflow_test
  playwright_browser: chromium
  test_timeout: 30000  # 30 seconds

# ============================================================================
# File Storage
# ============================================================================
storage:
  type: local
  local_path: ./uploads
  max_file_size: 10485760  # 10 MB

# ============================================================================
# Logging
# ============================================================================
logging:
  level: DEBUG
  format: detailed
  output:
    - console
  # No file logging in development (use docker logs instead)
